# Шпаргалка по 1801ВМ2 от В. Полетаева #
```
Вывод 29 "HALT" (переход вниз) -- в пульт
Вывод 31 "SEL"  (переход вниз) -- системное ОЗУ (с адресом)
         c DIN  (переход вниз) -- чтение начальных условий
```

**Начальный пуск**
```
  АВП(15:8) := SEL(15:8)    АВП -- адрес вектора начального пуска
  АВП( 7:0) := 0
  R7  := (АВП)
  РСП := (АВП + 2)

8 разряд РСП -- HALT/USER
  Загрузка по RTI, RTT, если новый СК(15:13) = 111,
  Сохраняется при MTPS, RTI, RTT,
  Обнуляется при TRAP, IOT, EMT, прерываниях
  Загружается при HALT, ШАГ, ПУСК
```

**Команды**
```
  *** = SEL(15:8)

  HALT
    РСП(8) := 1
    КРСП <- РСП
    КСК  <- СК
    СК   <- ***170
    РСП  <- ***172

  FADD, FSUB, FMUL, FDIV    0750CR
                                  C = 0..3
    Если SEL(7) = 1 -- TRAP to 10
         SEL(7) = 0, то переход в HALT с вектором ***???
```
**Специальные команды режима HALT**
```
    В режиме "USER" -- TRAP to 10.

  GO   ПУСК     000012
    СК <- КРСК
    РСП(8:0) <- КРСП(8:0)
    после этого анализ запроса на прерывание

  STEP  ШАГ     000016
    Аналогично ПУСК, но 1 команда всегда выполняется.

  RSEL  ЧПТ (чтение порта)  000020
    R0 <- SEL

  MFUS  ЧЧП (чтение чужого пространства)  000021
    R0 <- (R5)+ из режима USER

  RPC   ЧКСК (чтение копии счетчика команд)  000022
    R0 <- КРСК

  RPS   ЧКСП (чтение копии регистра СП)  000024
  
  MTUS  ЗЧП (запись чужого пространства)  000031
    R0 -> -(R5)

  WPC   ЗКСК (запись копии СК)  000032
    R0 -> КРСК

  WPS   ЗКСП (запись копии СП)  000034
    R0 -> КРСП
```

TODO: 3 лист -- Время выполнения команд

**Прерывания**
```
--------------------------------------------
РСП(8) | РСП(7) |  Маскируемые прерывания
--------------------------------------------
   0   |    0   |  нет
   0   |    1   |  EVENT, VIRQ
   1   |    0   |  HALT
   1   |    1   |  HALT, ACLO, EVENT, VIRQ
--------------------------------------------

Вектора
       4     стек   Зависание при передаче данных по каналу или запрещенный код
      10     стек   Резервный код
      14     стек   T-разряд
      24     стек   ACLO
     100     стек   EVENT
 считывается стек   VIRQ
  ***000     ----   включение питания
  ***004     КСК    зависание в режиме HALT
  ***010     КСК    FADD
  ***170     КСК    HALT
  ***174     КСК    двойное зависание
  ***274     КСК    зависание при приеме вектора прерывания
```

TODO: лист 5 -- ПЗУ пультового режима МС 1201.02

TODO: лист 6 -- Эмулятор FIS