#summary IDE-контроллеры и винчестеры для УКНЦ

IDE-контроллер для УКНЦ -- это плата расширения для вставки в разъём картриджа, в качестве корпуса для устройства обычно использовался корпус КМД УКНЦ с подпиленной верхней частью. Винчестер ноутбучного формата прикреплялся прямо к печатной плате.

http://ukncbtl.googlecode.com/svn/trunk/docs/UKNC_IDEHDD.jpeg

Адресное пространство контроллера винчестера входит в окно 100000-117777. Подключается контроллер сбросом бита 0 в регистре 177054 (он отключает одновременно системное ПЗУ в диапазоне 100000-117777), и установкой или сбросом бита 3 в том же регистре (указывает номер слота). Само загрузочное ПЗУ расположено в диапазоне 100000-107777. В диапазоне 110000-117777 расположены регистры IDE. Собственно сама шина QBUS инверсная, поэтому инверсны и адреса IDE и данные, которые читаются и пишутся (собственно для самих записываемых и считываемых данных это по барабану, инвертировалось сначала при записи, обратно при чтении, а вот для команд это играет роль). Для адресации регистров контроллера используются линии AD1, AD2 и AD3.

Соответствие регистров на PC и УКНЦ:
{{{
 1F0 110016
 1F1 110014
 1F2 110012
 1F3 110010
 1F4 110006
 1F5 110004
 1F6 110002
 1F7 110000
}}}
Регистров, которым на PC соответствуют 3F6 и 3F7, нет.

В самом первом секторе записана таблица разделов. В первых двух байтах записаны кол-во секторов в дорожке и кол-во сторон в дорожке, эта информация нужны для вычисления номера дорожки при переводе номера блока в RT-11 в CHS. Далее идут размеры разделов, каждый элемент занимает одно слово (два байта), размеры указаны в блоках RT-11. В самом конце сектора два слова контрольной суммы.

Существует две известных прошивки для контроллера IDE:
 * HDBOOT от ТОО "Электронные работы" -- используется драйвер ID -- до 8 разделов
 * WDROM от Олега Ховайко -- используются драйвера WD/WE/WF -- до 24 разделов. Загрузка возможна только с разделов WD.

== Ссылки ==
 * Фотографии платы, схемы устройства: http://uknc.narod.ru/Suvorov/index.htm
 * Тема на zx.pk.ru: http://zx.pk.ru/showthread.php?t=12218