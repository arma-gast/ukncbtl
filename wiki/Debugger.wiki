#summary Описание встроенного отладчика.
#labels Featured

= Встроенный отладчик =

То что отличает наш эмулятор от других, и может быть именно то благодаря чему мы достигли большого прогресса -- наш встроенный отладчик.

http://ukncbtl.googlecode.com/svn/trunk/docs/screenshot/UKNCBTL-Debugger-small.png

[http://ukncbtl.googlecode.com/svn/trunk/docs/screenshot/UKNCBTL-Debugger.png Снимок в полном размере]

Слева вверху -- экран УКНЦ.
Слева внизу -- отладочная консоль, в которой можно вводить команды; краткий список команд выдается по команде h.
Справа вверху -- окно состояния текущего процессора: вверху в боксе его регистры, справа от них содержимое стека, ниже дизассемблированный блок возле адреса PC; правее вверху -- состояние портов, внизу -- состояние каналов обмена данными между процессорами.
Справа внизу -- окно состояния памяти.

Красным цветом везде отмечены ячейки памяти, которые изменились после очередного шага или прогона. Перед шагом/запуском сохраняется состояние всей памяти и регистров процессоров, что позволяет о каждой ячейке сказать, изменилась ли она.

== Субтитры ==

В окне дизассемблера есть возможность загрузки "субтитров" -- подготовленного текста с комментариями к дизассемблированному коду. Для загрузки субтитров нужно щёлкнуть в окно дизассемблера и нажать клавишу 's'.

Пример текста субтитров:
{{{
; П/п поиска пилот-тона перед заголовком
130060: MTPS	#200		; Запретить прерывания
130064: MOV	23314$,R2	; R2 = число перепадов уровня при поиске загол.
130070: MOV	R5,R4		; R4 = длина предыдущего интервала
130072: CALL	130636$		; Проверка нажатия "СТОП"
130076:	BIT	#40,@#177710	; Перепад произошел ?
130104:	BEQ	130072$		; Нет
130106:	MOV	@#177714,R5	; R5 = длина текущего интервала
130112: TST	@#177714	; Сбросить готовность таймера
130116:	BIT	#250,@#177710	; Готовность сброшена ?
130124:	BNE	130112$		; Нет
130126:	SUB	R5,R4		; Вычислить разность между длинами интервалов
130130:	BPL	130134$
130132:	NEG	R4
130134: CMP	R4,23322$	; Разброс длин в норме ?
130140:	BHI	130064$		; Нет
130142:	SOB	R2,130070$	; Цикл по R2
130144:	MOV	#10,R3
130150:	MTPS	#0
	RETURN
}}}
